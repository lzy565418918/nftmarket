# æ„å»ºå¼ºå¤§çš„ Next.js Web3 å¤šé“¾ NFT äº¤æ˜“å¹³å°

## 1. æ­å»º Next.js é¡¹ç›®

1. åœ¨ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºé¡¹ç›®ï¼ˆä»¥ Next.js 14.x ä¸ºä¾‹ï¼‰ï¼š

  ```bash
  npx create-next-app@14 nftMarket
  ```

  > **è¯´æ˜**ï¼š`npx` æ˜¯ä¸€ä¸ªç”¨äºä¸´æ—¶è¿è¡Œ npm åŒ…çš„å·¥å…·ã€‚ä¸ `npm` ä¸åŒï¼Œ`npx` åœ¨æ‰§è¡Œå®Œå‘½ä»¤åä¼šè‡ªåŠ¨æ¸…ç†ä¸´æ—¶å®‰è£…çš„åŒ…ï¼Œä½†ä¸ä¼šåˆ é™¤é¡¹ç›®ä¸­çš„ `node_modules` æ–‡ä»¶å¤¹ã€‚`node_modules` åªä¼šåœ¨ä½ æ‰‹åŠ¨åˆ é™¤æˆ–è¿è¡Œç‰¹å®šå‘½ä»¤æ—¶è¢«ç§»é™¤ã€‚  
  > æœ¬é¡¹ç›®æ¨èä½¿ç”¨ **Next.js 14.x** ç‰ˆæœ¬ã€‚

2. å®‰è£… Hardhatï¼ˆä»¥å¤ªåŠå¼€å‘ç¯å¢ƒï¼Œæ¨èä½¿ç”¨ Hardhat 2.22.xï¼‰ï¼š

  ```bash
  npm install hardhat@2.22
  ```

  > **è¯´æ˜**ï¼šHardhat å¯ä»¥å¸®åŠ©æˆ‘åœ¨æœ¬åœ°æ­å»ºä»¥å¤ªåŠå¼€å‘ç¯å¢ƒï¼Œé¿å…ç›´æ¥è¿æ¥åˆ°å…¬å…±æˆ–ç§äºº RPC èŠ‚ç‚¹ã€‚é€šè¿‡é…ç½® Hardhat ç½‘ç»œï¼Œæˆ‘å¯ä»¥è¿æ¥ä¸åŒçš„åŒºå—é“¾èŠ‚ç‚¹ï¼ˆå¦‚æœ¬åœ°èŠ‚ç‚¹ã€æµ‹è¯•ç½‘æˆ–ä¸»ç½‘ï¼‰ï¼Œå…·ä½“æ–¹å¼æ˜¯åœ¨ `hardhat.config.js` æ–‡ä»¶ä¸­è®¾ç½® `networks` å±æ€§ã€‚  
  > æœ¬é¡¹ç›®æ¨èä½¿ç”¨ **Hardhat 2.22.x** ç‰ˆæœ¬ã€‚

## 2. å¯åŠ¨ Hardhatã€æœ¬åœ°èŠ‚ç‚¹ä¸è¿æ¥é’±åŒ…

1. è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆå§‹åŒ– Hardhat é¡¹ç›®ï¼š

  ```bash
  npx hardhat init
  ```

  > **è¯´æ˜**ï¼šæ‰§è¡Œè¯¥å‘½ä»¤åï¼Œä¼šè¿›å…¥ Hardhat çš„é¡¹ç›®åˆå§‹åŒ–å‘å¯¼ï¼Œå¯ä»¥é€‰æ‹©åˆ›å»ºä¸€ä¸ªåŸºç¡€æ ·æ¿é¡¹ç›®ã€‚åˆå§‹åŒ–å®Œæˆåï¼Œé¡¹ç›®ç›®å½•ä¸‹ä¼šåŒ…å«ç¤ºä¾‹åˆçº¦ã€æµ‹è¯•è„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼Œä¸ºåç»­çš„æ™ºèƒ½åˆçº¦å¼€å‘ä¸æµ‹è¯•æä¾›å®Œæ•´çš„æœ¬åœ°å¼€å‘ç¯å¢ƒã€‚æ›´å¤šå¯ç‚¹å‡»æŸ¥çœ‹ [Hardhat å®˜æ–¹æ–‡æ¡£](https://hardhat.org/getting-started/)

2. æŸ¥çœ‹æœ¬åœ°æµ‹è¯•é’±åŒ…

  åœ¨ Hardhat çš„æ–°ç‰ˆæœ¬ä¸­ï¼Œ`npx hardhat accounts` å‘½ä»¤å·²è¢«ç§»é™¤ã€‚ç°åœ¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨æœ¬åœ°èŠ‚ç‚¹ï¼Œå¹¶æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„æµ‹è¯•è´¦æˆ·å’Œç§é’¥ï¼š

  ```bash
  npx hardhat node
  ```

  å¯åŠ¨åï¼Œç»ˆç«¯ä¼šè¾“å‡ºä¸€ç»„æµ‹è¯•è´¦æˆ·åŠå…¶ç§é’¥ï¼Œæ¯ä¸ªè´¦æˆ·éƒ½é¢„ç½®äº†å¤§é‡æµ‹è¯•ç”¨ ETHï¼Œæ–¹ä¾¿å¼€å‘å’Œæµ‹è¯•ä½¿ç”¨ã€‚

  ![hardhatæä¾›çš„rpcèŠ‚ç‚¹å’Œé’±åŒ…ç§é’¥](img/image.png)
  æˆ‘å¯ä»¥çœ‹åˆ° Hardhat ä¸ºæˆ‘å¯åŠ¨äº†ä¸€ä¸ªæœ¬åœ°çš„ RPC èŠ‚ç‚¹ï¼Œå¹¶ç”Ÿæˆäº†å¤šä¸ªæ‹¥æœ‰å·¨é¢ä»¥å¤ªå¸çš„æµ‹è¯•é’±åŒ…ã€‚

3. è¿æ¥é’±åŒ…ï¼ˆä»¥ MetaMask ä¸ºä¾‹ï¼‰

  - åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ MetaMaskï¼Œç‚¹å‡»ç½‘ç»œé€‰æ‹©å™¨ï¼Œæ·»åŠ è‡ªå®šä¹‰ç½‘ç»œã€‚å°†ç½‘ç»œ RPC åœ°å€è®¾ç½®ä¸º `http://127.0.0.1:8545`ï¼Œé“¾ ID è®¾ç½®ä¸º `31337`ï¼ˆHardhat é»˜è®¤é“¾ IDï¼‰ï¼Œä¿å­˜ååˆ‡æ¢åˆ°è¯¥ç½‘ç»œã€‚
    ![æ·»åŠ è‡ªå®šä¹‰ç½‘ç»œ](img/image-1.png)
  - é€‰æ‹©â€œå¯¼å…¥è´¦æˆ·â€ï¼Œé€‰æ‹©â€œä½¿ç”¨ç§é’¥å¯¼å…¥â€ï¼Œå°†åˆšæ‰åœ¨ç»ˆç«¯ä¸­ Hardhat è¾“å‡ºçš„ä»»æ„ä¸€ä¸ªç§é’¥ç²˜è´´è¿›å»ï¼Œç‚¹å‡»ç¡®è®¤ã€‚
    ![æ·»åŠ é’±åŒ… - é€‰æ‹©ç§é’¥](img/image-2.png)
    ![å¤åˆ¶ç§é’¥ - ç¡®è®¤](img/image-3.png)
  - å¯¼å…¥æˆåŠŸåï¼Œæˆ‘å¯ä»¥çœ‹åˆ°è¯¥è´¦æˆ·æ‹¥æœ‰å¤§é‡æµ‹è¯• ETHï¼Œè¯´æ˜è¿æ¥æˆåŠŸã€‚
    ![è´¦æˆ·ä½™é¢](img/image-4.png)

  > ğŸ’¡ å°æç¤ºï¼šå½“é’±åŒ…è¿æ¥åˆ° Hardhat æä¾›çš„æœ¬åœ° RPC èŠ‚ç‚¹åï¼Œæ‰€æœ‰ä¸é’±åŒ…ç›¸å…³çš„é“¾ä¸Šäº¤äº’ï¼ˆå¦‚è½¬è´¦ã€éƒ¨ç½²åˆçº¦ç­‰ï¼‰éƒ½ä¼šå®æ—¶æ˜¾ç¤ºåœ¨è¿è¡Œ `npx hardhat node` çš„ç»ˆç«¯çª—å£ä¸­ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œè¿½è¸ªã€‚
  ![äº¤äº’åŠ¨ä½œ](img/image-5.png)

## 3. è¿æ¥æ™ºèƒ½åˆçº¦

æˆ‘å¯ä»¥é€šè¿‡ Remix IDE è¿›è¡Œåˆçº¦çš„éƒ¨ç½²å’Œäº¤äº’ã€‚æ‰“å¼€ [Remix IDE](https://remix.ethereum.org/)ï¼Œåœ¨â€œéƒ¨ç½²ä¸è¿è¡Œäº¤æ˜“â€é¢æ¿ä¸­ï¼Œé€‰æ‹©â€œInjected Provider - MetaMaskâ€ä½œä¸ºç¯å¢ƒï¼Œç¡®ä¿å·²è¿æ¥åˆ°åˆšæ‰æ·»åŠ çš„æœ¬åœ° Hardhat ç½‘ç»œã€‚é€‰æ‹©è¦éƒ¨ç½²çš„åˆçº¦ï¼Œç‚¹å‡»â€œDeployâ€å³å¯é€šè¿‡æœ¬åœ°é’±åŒ…ä¸ Hardhat èŠ‚ç‚¹è¿›è¡Œäº¤äº’ã€‚

![Remixè¿æ¥é’±åŒ…](img/image-6.png)

---

## NFT å¸‚åœºçš„æ ¸å¿ƒéœ€æ±‚ä¸æµç¨‹

### 1. å–æ–¹æµç¨‹

- å–æ–¹éœ€è¦æœ‰ä¸€ä¸ª NFT åˆ—è¡¨ï¼Œç”¨äºå±•ç¤ºå…¶å¾…å”®çš„ NFTã€‚æ¯ä¸ªåˆ—è¡¨é¡¹åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š
  - `itemId`ï¼šå¸‚åœºå†…çš„å”¯ä¸€æ ‡è¯†
  - `tokenId`ï¼šNFT åˆçº¦ä¸­çš„å”¯ä¸€æ ‡è¯†
  - `seller`ï¼šå–æ–¹çš„é’±åŒ…åœ°å€
  - `price`ï¼šNFT å”®ä»·ï¼ˆå¯ä¸ºåŸç”Ÿä»£å¸æˆ–æŒ‡å®šä»£å¸ï¼‰
  - `owner`ï¼šå½“å‰æ‹¥æœ‰è€…ï¼ˆä¸Šæ¶åä¸ºå¸‚åœºåˆçº¦åœ°å€ï¼‰

- å–æ–¹æ“ä½œæµç¨‹ï¼š
  1. æˆ‘é€‰æ‹©è¦å‡ºå”®çš„ NFTï¼Œç‚¹å‡»â€œå–å‡ºâ€æŒ‰é’®ã€‚
  2. è§¦å‘é“¾ä¸Šäº¤æ˜“ï¼Œå°† NFT è½¬ç§»åˆ°å¸‚åœºåˆçº¦åœ°å€ã€‚
  3. å¸‚åœºåˆçº¦è®°å½•è¯¥ NFT çš„è¯¦ç»†ä¿¡æ¯ã€‚

- åˆçº¦ç«¯éœ€å®ç°çš„åŠŸèƒ½ï¼š
  1. æ£€æŸ¥ NFT æ˜¯å¦å·²åœ¨å¸‚åœºåˆ—è¡¨ä¸­ï¼ˆå»é‡ï¼‰ã€‚
  2. å¡«å†™å¹¶è®°å½•å”®ä»·ã€‚
  3. è°ƒç”¨ NFT åˆçº¦ï¼Œå®Œæˆ tokenId çš„è½¬è®©ã€‚

### 2. ä¹°æ–¹æµç¨‹

1. æˆ‘å¯ä»¥æµè§ˆå¸‚åœºä¸Šçš„ NFT åˆ—è¡¨ï¼ˆè¿™äº›åˆ—è¡¨æ˜¯é€šè¿‡è°ƒç”¨åˆçº¦çš„æ¥å£å±•ç¤ºå‡ºæ¥çš„ï¼‰ã€‚
2. é€‰æ‹©å¿ƒä»ªçš„ NFTï¼Œç‚¹å‡»è´­ä¹°ï¼Œè°ƒç”¨åˆçº¦çš„ transfer æ–¹æ³•ï¼Œè°ƒèµ·é’±åŒ…ï¼Œæ”¯ä»˜ç›¸åº”ä»·æ ¼ï¼ˆé€šå¸¸èµ„é‡‘ä¼šå…ˆå­˜å…¥å¸‚åœºåˆçº¦ï¼Œç”±åˆçº¦æ‰˜ç®¡ï¼Œç¡®ä¿äº¤æ˜“å®‰å…¨ï¼Œä¹‹åå†è½¬ç»™å–å®¶ï¼‰ã€‚
3. åˆçº¦ä¼šå°† NFT çš„æ‰€æœ‰æƒè½¬ç»™æˆ‘ï¼ˆé€šè¿‡è°ƒç”¨ NFT åˆçº¦çš„ `transferFrom` æ–¹æ³•ï¼Œå°† tokenId çš„æ‰€æœ‰è€…åœ°å€ä¿®æ”¹ä¸ºæˆ‘çš„é’±åŒ…åœ°å€ï¼‰ã€‚

---

## å¸¸è§é—®é¢˜è§£ç­” ğŸ¤”

**Q: NFT åˆ—è¡¨çš„æ•°æ®æ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ**  
A: NFT åˆ—è¡¨é€šå¸¸æ˜¯é€šè¿‡è°ƒç”¨å¸‚åœºåˆçº¦çš„æ¥å£ï¼ˆå¦‚ `fetchMarketItems`ï¼‰è·å–çš„ï¼Œåˆçº¦ä¼šè¿”å›æ‰€æœ‰åœ¨å”® NFT çš„è¯¦ç»†ä¿¡æ¯ã€‚

**Q: ä¹°å®¶æ”¯ä»˜çš„ ETH æ˜¯ç›´æ¥ç»™å–å®¶å—ï¼Ÿ**  
A: ä¸€èˆ¬ä¸æ˜¯ã€‚ä¹°å®¶æ”¯ä»˜çš„ ETH ä¼šå…ˆå­˜å…¥å¸‚åœºåˆçº¦ï¼Œç”±åˆçº¦æ‰˜ç®¡ï¼Œç­‰äº¤æ˜“å®Œæˆåå†è½¬ç»™å–å®¶ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢æ¬ºè¯ˆã€‚

**Q: NFT çš„æ‰€æœ‰æƒæ˜¯æ€ä¹ˆè½¬ç§»çš„ï¼Ÿ**  
A: åˆçº¦ä¼šè°ƒç”¨ NFT åˆçº¦çš„ `transferFrom` æ–¹æ³•ï¼Œå°† NFT çš„æ‰€æœ‰è€…åœ°å€ä»å¸‚åœºåˆçº¦åœ°å€ä¿®æ”¹ä¸ºä¹°å®¶çš„é’±åŒ…åœ°å€ã€‚

**Q: å¦‚ä½•ä¿è¯ NFT ä¸ä¼šé‡å¤ä¸Šæ¶ï¼Ÿ**  
A: åˆçº¦ä¼šåœ¨ä¸Šæ¶å‰æ£€æŸ¥ NFT æ˜¯å¦å·²å­˜åœ¨äºå¸‚åœºåˆ—è¡¨ä¸­ï¼Œé˜²æ­¢é‡å¤ä¸Šæ¶ã€‚

---

> ğŸš€ é€šè¿‡ä»¥ä¸Šæµç¨‹ï¼Œæˆ‘å¯ä»¥å¿«é€Ÿæ­å»ºä¸€ä¸ªæ”¯æŒå¤šé“¾çš„ Web3 NFT äº¤æ˜“å¹³å°ï¼Œä½“éªŒå®Œæ•´çš„é“¾ä¸Š NFT äº¤æ˜“æµç¨‹ï¼

nft collection smart contract address: 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
nft marketplace smart contract address: 0x0165878A594ca255338adfa4d48449f69242Eb8F